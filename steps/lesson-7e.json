{
    "id": "lesson-7e",
    "title": "Lesson 7e: Galaxy Rendering",
    "steps": [
        {
            "title": "Rendering Stars & Objects",
            "content": "<p>Draw the galaxy as a field of stars with orbiting objects.</p><div class=\"info-box\"><strong>Rendering approach:</strong><br>â€¢ Clear canvas<br>â€¢ Draw stars at sector centers<br>â€¢ Draw orbital objects around each sector<br>â€¢ Draw connections/routes<br>â€¢ Update positions each frame</div><p style=\"margin-top: 15px;\"><strong>Rendering pipeline:</strong></p><ol style=\"margin: 10px 0 10px 20px;\"><li>Calculate camera position (what sector to show)</li><li>Draw background starfield</li><li>For each visible sector: draw objects</li><li>Draw UI overlays (coordinates, legends)</li></ol>"
        },
        {
            "title": "Star Field Background",
            "content": "<p><strong>Create a realistic starfield:</strong></p><div class=\"code-block\"><code class=\"language-javascript\">class GalaxyRenderer {\n    constructor(canvasId) {\n        this.canvas = document.getElementById(canvasId);\n        this.ctx = this.canvas.getContext('2d');\n        this.cameraX = 5;  // Center on sector (5,5)\n        this.cameraY = 5;\n        this.zoom = 50;    // Pixels per sector\n    }\n    \n    // Convert world coordinates to screen coordinates\n    worldToScreen(worldX, worldY) {\n        const screenX = (worldX - this.cameraX) * this.zoom + this.canvas.width / 2;\n        const screenY = (worldY - this.cameraY) * this.zoom + this.canvas.height / 2;\n        return { screenX, screenY };\n    }\n    \n    // Draw background space\n    drawBackground() {\n        // Deep space background\n        this.ctx.fillStyle = '#0a0e27';\n        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n        \n        // Distant stars (parallax effect)\n        this.ctx.fillStyle = 'rgba(200, 200, 255, 0.3)';\n        for (let i = 0; i < 100; i++) {\n            const x = Math.sin(i * 123.456) * this.canvas.width;\n            const y = Math.cos(i * 789.012) * this.canvas.height;\n            const size = (i % 3) + 0.5;\n            this.ctx.fillRect(x, y, size, size);\n        }\n    }\n    \n    // Draw the grid of sectors\n    drawSectors(galaxy, gridSize) {\n        this.ctx.strokeStyle = '#333366';\n        this.ctx.lineWidth = 1;\n        \n        // Draw grid lines\n        for (let x = 0; x <= gridSize; x++) {\n            const start = this.worldToScreen(x, 0);\n            const end = this.worldToScreen(x, gridSize);\n            this.ctx.beginPath();\n            this.ctx.moveTo(start.screenX, start.screenY);\n            this.ctx.lineTo(end.screenX, end.screenY);\n            this.ctx.stroke();\n        }\n        \n        for (let y = 0; y <= gridSize; y++) {\n            const start = this.worldToScreen(0, y);\n            const end = this.worldToScreen(gridSize, y);\n            this.ctx.beginPath();\n            this.ctx.moveTo(start.screenX, start.screenY);\n            this.ctx.lineTo(end.screenX, end.screenY);\n            this.ctx.stroke();\n        }\n    }\n    \n    // Draw stars at sector centers\n    drawStars(galaxy) {\n        galaxy.forEach(sector => {\n            const sectorCenter = this.worldToScreen(sector.x + 0.5, sector.y + 0.5);\n            \n            // Only draw if visible\n            if (Math.abs(sectorCenter.screenX - this.canvas.width / 2) > this.canvas.width / 2 ||\n                Math.abs(sectorCenter.screenY - this.canvas.height / 2) > this.canvas.height / 2) {\n                return;\n            }\n            \n            // Draw star glow\n            const gradient = this.ctx.createRadialGradient(\n                sectorCenter.screenX, sectorCenter.screenY, 0,\n                sectorCenter.screenX, sectorCenter.screenY, 15\n            );\n            gradient.addColorStop(0, 'rgba(255, 255, 200, 0.8)');\n            gradient.addColorStop(1, 'rgba(255, 200, 100, 0.1)');\n            \n            this.ctx.fillStyle = gradient;\n            this.ctx.beginPath();\n            this.ctx.arc(sectorCenter.screenX, sectorCenter.screenY, 15, 0, Math.PI * 2);\n            this.ctx.fill();\n            \n            // Draw star core\n            this.ctx.fillStyle = '#FFFF99';\n            this.ctx.beginPath();\n            this.ctx.arc(sectorCenter.screenX, sectorCenter.screenY, 3, 0, Math.PI * 2);\n            this.ctx.fill();\n            \n            // Label\n            this.ctx.fillStyle = '#CCCCAA';\n            this.ctx.font = '10px Arial';\n            this.ctx.textAlign = 'center';\n            this.ctx.fillText(`(${sector.x},${sector.y})`, \n                             sectorCenter.screenX, \n                             sectorCenter.screenY + 25);\n        });\n    }\n}\n</code></div><div class=\"read-more\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createRadialGradient\" target=\"_blank\">MDN: createRadialGradient()</a> - Radial color gradients</div>"
        },
        {
            "title": "Rendering Orbiting Objects",
            "content": "<p><strong>Draw planets and stations orbiting each star:</strong></p><div class=\"code-block\"><code class=\"language-javascript\">class GalaxyRenderer {\n    // ... previous code ...\n    \n    // Draw objects orbiting around sectors\n    drawOrbits(galaxy) {\n        galaxy.forEach(sector => {\n            const sectorCenter = this.worldToScreen(sector.x + 0.5, sector.y + 0.5);\n            \n            sector.objects.forEach(obj => {\n                const pos = obj.getPosition();\n                // Scale object positions to screen\n                const objScreen = this.worldToScreen(\n                    sector.x + 0.5 + pos.x / 100,\n                    sector.y + 0.5 + pos.y / 100\n                );\n                \n                // Draw orbit radius as faint circle\n                const orbitRadius = obj.orbitRadius / 100 * this.zoom;\n                this.ctx.strokeStyle = 'rgba(100, 100, 150, 0.2)';\n                this.ctx.lineWidth = 1;\n                this.ctx.beginPath();\n                this.ctx.arc(sectorCenter.screenX, sectorCenter.screenY, \n                           orbitRadius, 0, Math.PI * 2);\n                this.ctx.stroke();\n                \n                // Draw connection to star\n                this.ctx.strokeStyle = 'rgba(100, 150, 200, 0.3)';\n                this.ctx.lineWidth = 1;\n                this.ctx.beginPath();\n                this.ctx.moveTo(sectorCenter.screenX, sectorCenter.screenY);\n                this.ctx.lineTo(objScreen.screenX, objScreen.screenY);\n                this.ctx.stroke();\n                \n                // Draw object\n                this.ctx.fillStyle = '#00FF00';\n                this.ctx.beginPath();\n                this.ctx.arc(objScreen.screenX, objScreen.screenY, 4, 0, Math.PI * 2);\n                this.ctx.fill();\n                \n                // Label (for large objects)\n                if (obj.name.includes('Station') || obj.name.includes('Planet')) {\n                    this.ctx.fillStyle = '#AAFFAA';\n                    this.ctx.font = '9px Arial';\n                    this.ctx.textAlign = 'center';\n                    this.ctx.fillText(obj.name, objScreen.screenX, objScreen.screenY - 10);\n                }\n            });\n        });\n    }\n    \n    // Main render function\n    render(galaxy) {\n        this.drawBackground();\n        this.drawSectors(galaxy, 10);\n        this.drawStars(galaxy);\n        this.drawOrbits(galaxy);\n        this.drawUI();\n    }\n    \n    // Draw HUD overlay\n    drawUI() {\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.6)';\n        this.ctx.fillRect(10, 10, 200, 60);\n        \n        this.ctx.fillStyle = '#FFFFFF';\n        this.ctx.font = 'bold 12px Arial';\n        this.ctx.textAlign = 'left';\n        this.ctx.fillText(`Camera: (${this.cameraX.toFixed(1)}, ${this.cameraY.toFixed(1)})`, 15, 25);\n        this.ctx.fillText(`Zoom: ${this.zoom}x`, 15, 40);\n        this.ctx.font = '10px Arial';\n        this.ctx.fillText('Arrow keys to move', 15, 55);\n    }\n}\n\n// Usage with animation loop\nconst renderer = new GalaxyRenderer('galaxyCanvas');\nconst galaxy = generateGalaxy(10);  // 10x10 sectors\n\nfunction animate() {\n    // Update all objects (simulate time passing)\n    galaxy.forEach(sector => {\n        sector.objects.forEach(obj => obj.update(0.01));  // 0.01 hours per frame\n    });\n    \n    // Render\n    renderer.render(galaxy);\n    \n    // Continue animation\n    requestAnimationFrame(animate);\n}\n\nanimate();</code></div><div class=\"read-more\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame\" target=\"_blank\">MDN: requestAnimationFrame()</a> - Smooth 60fps animation</div>"
        },
        {
            "title": "Camera Control & Panning",
            "content": "<p><strong>Let players navigate the galaxy:</strong></p><div class=\"code-block\"><code class=\"language-javascript\">class GalaxyRenderer {\n    // ... previous code ...\n    \n    setupControls() {\n        const panSpeed = 0.1;\n        \n        window.addEventListener('keydown', (e) => {\n            switch(e.key) {\n                case 'ArrowUp':\n                case 'w': this.cameraY -= panSpeed; break;\n                case 'ArrowDown':\n                case 's': this.cameraY += panSpeed; break;\n                case 'ArrowLeft':\n                case 'a': this.cameraX -= panSpeed; break;\n                case 'ArrowRight':\n                case 'd': this.cameraX += panSpeed; break;\n                case '+': this.zoom *= 1.1; break;\n                case '-': this.zoom /= 1.1; break;\n            }\n        });\n        \n        // Mouse wheel zoom\n        this.canvas.addEventListener('wheel', (e) => {\n            e.preventDefault();\n            this.zoom *= (e.deltaY > 0 ? 0.9 : 1.1);\n        });\n        \n        // Click on sector\n        this.canvas.addEventListener('click', (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            const screenX = e.clientX - rect.left;\n            const screenY = e.clientY - rect.top;\n            \n            // Convert to world coordinates\n            const worldX = (screenX - this.canvas.width / 2) / this.zoom + this.cameraX;\n            const worldY = (screenY - this.canvas.height / 2) / this.zoom + this.cameraY;\n            \n            const sectorX = Math.floor(worldX);\n            const sectorY = Math.floor(worldY);\n            \n            console.log(`Clicked sector: (${sectorX}, ${sectorY})`);\n        });\n    }\n}\n\n// Initialize\nconst renderer = new GalaxyRenderer('galaxyCanvas');\nrenderer.setupControls();</code></div><div class=\"read-more\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/wheel_event\" target=\"_blank\">MDN: wheel Event</a> - Mouse wheel scrolling</div>"
        },
        {
            "title": "Lesson 7e Complete! ðŸŽ‰",
            "content": "<p style=\"font-size: 1.1em;\"><strong>You've rendered an interactive galaxy map.</strong></p><div style=\"margin: 20px 0;\"><div class=\"achievement\">âœ“ Draw sectors and star fields</div><div class=\"achievement\">âœ“ Render orbiting objects</div><div class=\"achievement\">âœ“ Implement camera controls</div><div class=\"achievement\">âœ“ Add zoom and panning</div><div class=\"achievement\">âœ“ Show orbital mechanics in real-time</div></div><p style=\"margin-top: 20px; color: #667eea; font-weight: bold;\">â†’ Next: Lesson 7f - Navigation Dashboard</p>"
        }
    ]
}
