{
    "id": "lesson-2d",
    "title": "Lesson 2d: Testing the Database",
    "steps": [
        {
            "title": "Create test-database.js",
            "content": "<p>Create <code>test-database.js</code> in the root folder to test our Database class:</p><div class=\"code-block\"><code class=\"language-javascript\">const db = require('./src/database');\n\nasync function testDatabase() {\n    console.log('=== Database Test ===\\n');\n    \n    // Test 1: Save some market data\n    console.log('Test 1: Saving market data...');\n    const markets = {\n        commodities: [\n            { name: 'iron_ore', price: 100, supply: 5000 },\n            { name: 'copper_ore', price: 75, supply: 3000 },\n            { name: 'uranium_ore', price: 500, supply: 100 }\n        ]\n    };\n    await db.saveFile('markets.json', markets);\n    console.log('âœ“ Saved successfully\\n');\n    \n    // Test 2: Read it back\n    console.log('Test 2: Reading market data...');\n    const loaded = await db.readFile('markets.json');\n    console.log('Loaded data:', loaded);\n    console.log('âœ“ Read successfully\\n');\n    \n    // Test 3: Verify data integrity\n    console.log('Test 3: Verifying data integrity...');\n    const matches = JSON.stringify(markets) === JSON.stringify(loaded);\n    if (matches) {\n        console.log('âœ“ Data matches perfectly!');\n    } else {\n        console.log('âœ— Data mismatch!');\n    }\n    console.log();\n    \n    // Test 4: Try reading non-existent file\n    console.log('Test 4: Reading non-existent file...');\n    const missing = await db.readFile('doesntexist.json');\n    console.log('Result:', missing);  // Should be null\n    console.log('âœ“ Handled gracefully\\n');\n    \n    // Test 5: Save nested data\n    console.log('Test 5: Saving complex nested data...');\n    const playerData = {\n        players: [\n            {\n                id: 'player1',\n                name: 'Alice',\n                balance: 50000,\n                inventory: { iron_ore: 100, copper_ore: 50 }\n            },\n            {\n                id: 'player2',\n                name: 'Bob',\n                balance: 75000,\n                inventory: { uranium_ore: 5 }\n            }\n        ]\n    };\n    await db.saveFile('players.json', playerData);\n    const loadedPlayers = await db.readFile('players.json');\n    console.log('Saved and loaded', loadedPlayers.players.length, 'players');\n    console.log('âœ“ Complex data works!\\n');\n    \n    console.log('=== All Tests Passed! ===')\n}\n\n// Run the tests\ntestDatabase().catch(error => {\n    console.error('Test failed:', error);\n    process.exit(1);\n});</code></div><div class=\"read-more\" style=\"margin-top: 15px; font-size: 0.9em;\"><strong>Read more on MDN:</strong><ul style=\"margin-top: 5px;\"><li><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function\" target=\"_blank\">async function</a></li><li><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify\" target=\"_blank\">JSON.stringify()</a></li><li><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach\" target=\"_blank\">Array.prototype.forEach()</a></li></ul></div>"
        },
        {
            "title": "Run the Tests",
            "content": "<p>Execute the test file:</p><div class=\"command\">node test-database.js</div><p style=\"margin-top: 15px;\">You should see output like:</p><div class=\"code-block\"><code class=\"language-text\">=== Database Test ===\n\nTest 1: Saving market data...\nâœ“ Saved successfully\n\nTest 2: Reading market data...\nLoaded data: { commodities: [ ... ] }\nâœ“ Read successfully\n\nTest 3: Verifying data integrity...\nâœ“ Data matches perfectly!\n\nTest 4: Reading non-existent file...\nResult: null\nâœ“ Handled gracefully\n\nTest 5: Saving complex nested data...\nSaved and loaded 2 players\nâœ“ Complex data works!\n\n=== All Tests Passed! ===</code></div>"
        },
        {
            "title": "Check the Generated Files",
            "content": "<p>Look in your <code>data/</code> folder with Windows Explorer or VS Code:</p><div class=\"code-block\"><code class=\"language-text\">c:\\Game Concept\\data\\\nâ”œâ”€â”€ markets.json\nâ””â”€â”€ players.json</code></div><p style=\"margin-top: 15px;\">Open <code>markets.json</code> in VS Code to see your saved data (pretty-printed!):</p><div class=\"code-block\"><code class=\"language-json\">{\n  \"commodities\": [\n    {\n      \"name\": \"iron_ore\",\n      \"price\": 100,\n      \"supply\": 5000\n    },\n    {\n      \"name\": \"copper_ore\",\n      \"price\": 75,\n      \"supply\": 3000\n    },\n    {\n      \"name\": \"uranium_ore\",\n      \"price\": 500,\n      \"supply\": 100\n    }\n  ]\n}</code></div><p style=\"margin-top: 15px;\"><strong>This is why JSON files are great for prototyping:</strong> You can actually READ and UNDERSTAND your data!</p>"
        },
        {
            "title": "Knowledge Check",
            "content": "<p>Verify your understanding of testing the database.</p>",
            "quiz": [
                {
                    "question": "Why do we test reading a non-existent file?",
                    "options": [
                        "To make the program crash",
                        "To ensure our code handles missing data gracefully (returns null) instead of crashing",
                        "To create the file automatically"
                    ],
                    "correct": 1
                },
                {
                    "question": "What is a major benefit of using JSON files for data storage during development?",
                    "options": [
                        "They are encrypted",
                        "They are faster than any database",
                        "They are human-readable and easy to debug"
                    ],
                    "correct": 2
                }
            ]
        },
        {
            "title": "Lesson 2 Complete! ðŸŽ‰",
            "content": "<p style=\"font-size: 1.1em;\"><strong>You've mastered data persistence with safe, atomic file operations.</strong></p><div style=\"margin: 20px 0;\"><div class=\"achievement\">âœ“ Built Database wrapper class</div><div class=\"achievement\">âœ“ Tested save and load operations</div><div class=\"achievement\">âœ“ Verified data integrity</div><div class=\"achievement\">âœ“ Handled edge cases</div></div><p style=\"margin-top: 20px;\"><strong>You can now:</strong></p><ul style=\"margin: 10px 0 10px 20px;\"><li>Save game state safely</li><li>Load data without corruption</li><li>Handle missing files gracefully</li><li>Debug your data in VS Code</li></ul><p style=\"margin-top: 20px; color: #667eea; font-weight: bold;\">â†’ Next: Lesson 3 - Market Analyzer</p>"
        }
    ]
}
