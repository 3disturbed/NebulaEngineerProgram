{
    "id": "lesson-7b",
    "title": "Lesson 7b: Building Price Charts",
    "steps": [
        {
            "title": "Time-Series Line Chart Pattern",
            "content": "<p>A <strong>line chart</strong> shows how a value changes over time. Perfect for visualizing price movements.</p><div class=\"info-box\"><strong>Key components:</strong><br>â€¢ X-axis: Time (hours)<br>â€¢ Y-axis: Price ($)<br>â€¢ Data points: Historical prices<br>â€¢ Connected lines: Price trend</div><p style=\"margin-top: 15px;\"><strong>Basic algorithm:</strong></p><ol style=\"margin: 10px 0 10px 20px;\"><li>Plot axis labels and grid</li><li>Calculate scale (map data values to pixels)</li><li>Plot data points</li><li>Connect points with lines</li></ol>"
        },
        {
            "title": "Drawing Axes & Grid",
            "content": "<p><strong>Create a coordinate system for your chart:</strong></p><div class=\"code-block\"><code class=\"language-javascript\">function drawChart(canvas, data, title) {\n    const ctx = canvas.getContext('2d');\n    const padding = 60;  // Space for labels\n    const width = canvas.width - 2 * padding;\n    const height = canvas.height - 2 * padding;\n    \n    // Title\n    ctx.font = '20px Arial';\n    ctx.fillStyle = '#FFFFFF';\n    ctx.textAlign = 'center';\n    ctx.fillText(title, canvas.width / 2, 30);\n    \n    // Y-axis (price)\n    ctx.strokeStyle = '#666666';\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.moveTo(padding, padding);\n    ctx.lineTo(padding, canvas.height - padding);\n    ctx.stroke();\n    \n    // X-axis (time)\n    ctx.beginPath();\n    ctx.moveTo(padding, canvas.height - padding);\n    ctx.lineTo(canvas.width - padding, canvas.height - padding);\n    ctx.stroke();\n    \n    // Grid lines and labels\n    ctx.strokeStyle = '#333333';\n    ctx.font = '12px Arial';\n    ctx.fillStyle = '#AAAAAA';\n    \n    // Horizontal grid (price)\n    const maxPrice = Math.max(...data);\n    const minPrice = Math.min(...data);\n    const priceStep = (maxPrice - minPrice) / 4;\n    \n    for (let i = 0; i <= 4; i++) {\n        const price = minPrice + (priceStep * i);\n        const y = canvas.height - padding - (i / 4) * height;\n        \n        ctx.beginPath();\n        ctx.moveTo(padding - 5, y);\n        ctx.lineTo(canvas.width - padding, y);\n        ctx.stroke();\n        \n        ctx.textAlign = 'right';\n        ctx.fillText('$' + price.toFixed(0), padding - 10, y + 4);\n    }\n    \n    // Vertical grid (time)\n    const timeStep = Math.ceil(data.length / 5);\n    for (let i = 0; i < data.length; i += timeStep) {\n        const x = padding + (i / (data.length - 1)) * width;\n        \n        ctx.beginPath();\n        ctx.moveTo(x, canvas.height - padding);\n        ctx.lineTo(x, canvas.height - padding + 5);\n        ctx.stroke();\n        \n        ctx.textAlign = 'center';\n        ctx.fillText('Hour ' + i, x, canvas.height - padding + 20);\n    }\n}\n</code></div><div class=\"read-more\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/strokeStyle\" target=\"_blank\">MDN: Canvas strokeStyle</a> - Line colors</div>"
        },
        {
            "title": "Plotting Data Points & Lines",
            "content": "<p><strong>Connect data points with lines to show trends:</strong></p><div class=\"code-block\"><code class=\"language-javascript\">function drawPriceLine(canvas, data, color = '#00FF00') {\n    const ctx = canvas.getContext('2d');\n    const padding = 60;\n    const width = canvas.width - 2 * padding;\n    const height = canvas.height - 2 * padding;\n    \n    // Find min/max for scaling\n    const maxPrice = Math.max(...data);\n    const minPrice = Math.min(...data);\n    const priceRange = maxPrice - minPrice || 1;  // Avoid division by zero\n    \n    // Draw the line\n    ctx.strokeStyle = color;\n    ctx.lineWidth = 3;\n    ctx.lineJoin = 'round';\n    ctx.beginPath();\n    \n    for (let i = 0; i < data.length; i++) {\n        // Map data value to pixel position\n        const x = padding + (i / (data.length - 1)) * width;\n        const y = canvas.height - padding - \n                  ((data[i] - minPrice) / priceRange) * height;\n        \n        if (i === 0) {\n            ctx.moveTo(x, y);\n        } else {\n            ctx.lineTo(x, y);\n        }\n    }\n    ctx.stroke();\n    \n    // Draw data points as circles\n    ctx.fillStyle = color;\n    for (let i = 0; i < data.length; i++) {\n        const x = padding + (i / (data.length - 1)) * width;\n        const y = canvas.height - padding - \n                  ((data[i] - minPrice) / priceRange) * height;\n        \n        ctx.beginPath();\n        ctx.arc(x, y, 4, 0, Math.PI * 2);\n        ctx.fill();\n    }\n}\n\n// Usage\nconst ironOreHistory = [100, 102, 104, 103, 106, 110, 108, 112, 115, 120];\nconst canvas = document.getElementById('priceChart');\ndrawChart(canvas, ironOreHistory, 'Iron Ore Price History');\ndrawPriceLine(canvas, ironOreHistory, '#FF6B35');</code></div><div class=\"read-more\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/arc\" target=\"_blank\">MDN: Canvas arc()</a> - Draw circles</div>"
        },
        {
            "title": "Real-Time Price Updates",
            "content": "<p><strong>Update chart as new price data arrives:</strong></p><div class=\"code-block\"><code class=\"language-javascript\">class PriceChart {\n    constructor(canvasId, maxDataPoints = 24) {\n        this.canvas = document.getElementById(canvasId);\n        this.data = [];\n        this.maxDataPoints = maxDataPoints;\n        this.colors = {\n            'Iron Ore': '#FF6B35',\n            'Copper Ore': '#F7931E',\n            'Uranium Ore': '#00D084'\n        };\n    }\n    \n    addPrice(itemName, price) {\n        // Initialize if needed\n        if (!this.data[itemName]) {\n            this.data[itemName] = [];\n        }\n        \n        // Add new data point\n        this.data[itemName].push(price);\n        \n        // Keep only recent data (sliding window)\n        if (this.data[itemName].length > this.maxDataPoints) {\n            this.data[itemName].shift();\n        }\n        \n        // Redraw chart\n        this.draw();\n    }\n    \n    draw() {\n        const ctx = this.canvas.getContext('2d');\n        ctx.fillStyle = '#1a1a2e';\n        ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n        \n        // Draw axes\n        drawChart(this.canvas, this.getAllPrices(), 'Market Prices');\n        \n        // Draw each item's line\n        for (const [itemName, prices] of Object.entries(this.data)) {\n            if (prices.length > 0) {\n                drawPriceLine(this.canvas, prices, this.colors[itemName]);\n            }\n        }\n    }\n    \n    getAllPrices() {\n        return Object.values(this.data).flat();\n    }\n}\n\n// Usage with WebSocket\nconst chart = new PriceChart('priceChart');\n\nsocket.on('market:update', (data) => {\n    data.items.forEach(item => {\n        chart.addPrice(item.name, item.price);\n    });\n});</code></div><div class=\"read-more\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes\" target=\"_blank\">MDN: JavaScript Classes</a> - Object-oriented programming</div>"
        },
        {
            "title": "Knowledge Check",
            "content": "<p>Verify your understanding of charting.</p>",
            "quiz": [
                {
                    "question": "Why do we need to scale data values when drawing on a canvas?",
                    "options": [
                        "Because canvas pixels are always 0-100",
                        "Because data values (e.g., price $500) might be larger or smaller than the canvas height in pixels",
                        "To make the lines thicker"
                    ],
                    "correct": 1
                },
                {
                    "question": "What happens if we don't clear the canvas (using `fillRect` or `clearRect`) before redrawing the chart?",
                    "options": [
                        "The new chart is drawn on top of the old one, creating a mess",
                        "The old chart disappears automatically",
                        "The canvas throws an error"
                    ],
                    "correct": 0
                }
            ]
        },
        {
            "title": "Lesson 7b Complete! ðŸŽ‰",
            "content": "<p style=\"font-size: 1.1em;\"><strong>You've built a professional price chart visualization.</strong></p><div style=\"margin: 20px 0;\"><div class=\"achievement\">âœ“ Draw axes and grid lines</div><div class=\"achievement\">âœ“ Plot data points accurately</div><div class=\"achievement\">âœ“ Connect points with smooth lines</div><div class=\"achievement\">âœ“ Handle real-time data updates</div><div class=\"achievement\">âœ“ Scale data to fit canvas</div></div><p style=\"margin-top: 20px; color: #667eea; font-weight: bold;\">â†’ Next: Lesson 7c - Market Heatmaps</p>"
        }
    ]
}
